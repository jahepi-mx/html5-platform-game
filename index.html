<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <style type="text/css">
        @font-face {
            font-family: 'joystix';
            src: url('assets/fonts/joystix.ttf');
        }
        </style>
        <script src="engine/config/config.js"></script>
        <script src="engine/levels/levelmanager.js"></script>
        <script src="engine/levels/level1.js"></script>
        <script src="engine/levels/level2.js"></script>
        <script src="engine/entities/tile.js"></script>
        <script src="engine/entities/hero.js"></script>
        <script src="engine/entities/heroblast.js"></script>
        <script src="engine/entities/coin.js"></script>
        <script src="engine/entities/beetleenemy.js"></script>
        <script src="engine/entities/lavaenemy.js"></script>
        <script src="engine/entities/staticenemy.js"></script>
        <script src="engine/entities/giantfatenemy.js"></script>
        <script src="engine/entities/zombieenemy.js"></script>
        <script src="engine/entities/spiderenemy.js"></script>
        <script src="engine/entities/skeletonenemy.js"></script>
        <script src="engine/entities/flydemonenemy.js"></script>
        <script src="engine/entities/dragonenemy.js"></script>
        <script src="engine/entities/enemyblast.js"></script>
        <script src="engine/resources/assets.js"></script>
        <script src="engine/resources/atlas.js"></script>
        <script src="engine/camera.js"></script>
        <script src="engine/gamerender.js"></script>
        <script src="engine/gamecontroller.js"></script>
        <script src="engine/animation.js"></script>
        <script src="engine/scenes/gamescene.js"></script>
        <script src="engine/scenes/mainscene.js"></script>
        <script src="engine/scenes/creditsscene.js"></script>
        <script>
            var scene;
            var context;
            var canvas;
            var prevTimestamp = 0;
            var isPaused = false;           
            
            window.onload = function() {
                canvas = document.getElementById("game");
                context = canvas.getContext("2d");
                canvas.width = Config.worldWidth;
                canvas.height = Config.worldHeight;
                screen.lockOrientationUniversal = screen.lockOrientation || screen.mozLockOrientation || screen.msLockOrientation;
                if (screen.lockOrientationUniversal !== undefined && screen.lockOrientationUniversal("landscape")) {
                  fullScreenOn(canvas);
                } else {
                  fullScreenOff();
                }
                scene = new MainScene(context, canvas, changeSceneCallback);
                window.requestAnimationFrame(onUpdate);    
            };
            
            function onUpdate(timestamp) {
                var deltatime = (timestamp - prevTimestamp) / 1000;
                // 3 fps minimum to update and draw game state
                if (1 / deltatime >= 3) {
                    scene.update(deltatime);
                }
                prevTimestamp = timestamp;
                window.requestAnimationFrame(onUpdate);
            }
            
            function changeSceneCallback(sceneName) {
                if (sceneName === "main") {
                    scene = new MainScene(context, canvas, changeSceneCallback);
                } else if (sceneName === "game") {
                    scene = new GameScene(context, canvas, changeSceneCallback);
                }  else if (sceneName === "credits") {
                    scene = new CreditsScene(context, canvas, changeSceneCallback);
                }
            }
            
            function fullScreenOn(element) {
                if (document.fullscreenEnabled || document.webkitFullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled) {
                    if ("requestFullscreen" in element) element.requestFullscreen();
                    else if ("webkitRequestFullscreen" in element) element.webkitRequestFullscreen();
                    else if ("mozRequestFullScreen" in element) element.mozRequestFullScreen();
                    else if ("msRequestFullscreen" in element) element.msRequestFullscreen();
                }
            }
            
            function fullScreenOff() {
                if ("exitFullscreen" in document) document.exitFullscreen();
                else if ("webkitExitFullscreen" in document) document.webkitExitFullscreen();
                else if ("mozCancelFullScreen" in document) document.mozCancelFullScreen();
                else if ("msExitFullscreen" in document) document.msExitFullscreen();
            }
        </script>
    </head>
    <body style="background-color: black">
        <canvas id="game" style="margin: 0 auto;"></canvas>
        <span style="font-family: joystix; display: none">Hidden text just for loading font before canvas.</span>
    </body>
</html>
